import{w as I}from"./index.43d63db3.js";import{C as S,V as T}from"./index.3d647e04.js";import{c as O,m as P}from"./authstore.ea07bff9.js";const g={};function b(e){return e==="local"?localStorage:sessionStorage}function _(e,o,r){const a=(r==null?void 0:r.serializer)??JSON,c=(r==null?void 0:r.storage)??"local",n=typeof window<"u"&&typeof document<"u";function l(t,f){n&&b(c).setItem(t,a.stringify(f))}if(!g[e]){const t=I(o,s=>{const i=n?b(c).getItem(e):null;if(i&&s(a.parse(i)),n){const E=h=>{h.key===e&&s(h.newValue?a.parse(h.newValue):null)};return window.addEventListener("storage",E),()=>window.removeEventListener("storage",E)}}),{subscribe:f,set:m}=t;g[e]={set(s){l(e,s),m(s)},update(s){const i=s(S(t));l(e,i),m(i)},subscribe:f}}return g[e]}_("modeOsPrefers",!1);_("modeUserPrefers",void 0);_("modeCurrent",!1);const U="localhost",x="8081",y="https://"+U+":"+x+"/api/v1/",R="digi-sense.tech",F="9091",H="https://"+R+":"+F+"/api/v1/",j="Husky Bot",C={"execution_error:record not found authorization_error":"login_error"},B={login_error:"Wrong Username or Password!"},d={ApiEndpoint:y,ApiAuthEndPoint:H,AppName:j,IconRobohash:function(e){return console.log("IconRobohash",e),"https://www.gravatar.com/avatar/"+e+"?s=64&d=https%3A%2F%2Frobohash.org%2F06143afe1d92f81341a7b913e2bdc492%3Fsize%3D64x64"},IconDiceBear:function(e){return"https://api.dicebear.com/5.x/pixel-art/svg?seed="+e},Errors:C,ErrorMessages:B};let u=P,p="",w="";O.subscribe(e=>{u=e,u&&u.auth&&(p=u.auth.access_token,w=u.auth.refresh_token),console.debug("updated user",p,w)});function D(e){return console.log("IconRobohash",e),"https://www.gravatar.com/avatar/"+e+"?s=64&d=https%3A%2F%2Frobohash.org%2F06143afe1d92f81341a7b913e2bdc492%3Fsize%3D64x64"}function k(e){return"https://api.dicebear.com/5.x/pixel-art/svg?seed="+e}function z(e,o){const r=setInterval(e,o);T(()=>{console.debug("onInterval.destroy"),clearInterval(r)})}function v(e){return e&&e.length>0?d.Errors[e]:""}function M(e){const o=v(e)||"";return o&&o.length>0?d.ErrorMessages[o]:""}const W={IconRobohash:D,IconDiceBear:k,OnInterval:z,GetErrorId:v,GetErrorMessage:M,AccessToken:function(){return p},RefreshToken:function(){return w}},A={"Content-Type":"application/json","Access-Control-Allow-Origin":"*"};async function N(){const e=await fetch(d.ApiAuthEndPoint+"sys/version",{method:"GET",headers:A}),r=(await e.json()).response;if(e.ok)return r;throw new Error(r)}async function G(e,o,r=""){const a={email:e,password:o,vat:r},c=await fetch(d.ApiAuthEndPoint+"auth/sign-in",{method:"POST",headers:A,body:JSON.stringify(a)}),n=await c.json(),l=n.response,t=n.error;if(c.ok){if(t)throw new Error(t);return l}else throw t?new Error(t):new Error("Generic Server Error")}const q={getVersion:N,signin:G};export{d as C,q as S,W as U};
